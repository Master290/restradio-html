<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>.restradio</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            overflow: hidden; /* Crucial for full-page pseudo-elements */
        }

        body {
            background: #000; /* Base black background */
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* Also good to have here */
            position: relative; /* Context for z-indexed pseudo-elements */
        }

        .container {
            text-align: center;
            max-width: 500px;
            width: 100%;
            padding: 2rem;
            margin: 0 auto;
        }

        .logo {
            font-size: 7rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            animation: glow 3s ease-in-out infinite alternate;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        .logo .dot {
            background: linear-gradient(45deg, #8b5cf6, #a855f7, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo .rest {
            color: white;
        }

        .logo .radio {
            background: linear-gradient(45deg, #8b5cf6, #a855f7, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 10px rgba(139, 92, 246, 0.3)); }
            to { filter: drop-shadow(0 0 20px rgba(139, 92, 246, 0.6)); }
        }

        .play-button {
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 32px rgba(139, 92, 246, 0.3);
            position: relative;
            overflow: hidden;
        }

        .play-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2), transparent);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .play-button:hover::before {
            opacity: 1;
        }

        .play-button:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 40px rgba(139, 92, 246, 0.4);
        }

        .play-button:active {
            transform: scale(0.98);
        }

        .play-icon, .stop-icon {
            fill: white;
            width: 20px;
            height: 20px;
            z-index: 1;
            position: relative;
        }

        .play-icon {
            margin-left: 2px;
        }

        .stop-icon {
            display: none;
        }

        .now-playing {
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.1rem;
            color: #c084fc;
            margin-bottom: 1.5rem;
            min-height: 30px;
        }

        .now-playing.show {
            opacity: 1;
            transform: translateY(0);
        }

        .status {
            font-size: 0.9rem;
            color: #9ca3af;
            margin-bottom: 1.5rem;
            opacity: 0;
            transform: translateY(-15px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1) 0.1s;
        }

        .status.show {
            opacity: 1;
            transform: translateY(0);
        }

        .loading {
            display: none;
            font-size: 0.9rem;
            color: #8b5cf6;
            margin-bottom: 1.5rem;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.4s ease;
        }

        .loading.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        @media (max-width: 480px) {
            .logo {
                font-size: 5rem;
            }
            
            .play-button {
                width: 55px;
                height: 55px;
            }
        }

    @keyframes twinkle {
        0%, 100% { opacity: 0.7; }
        50% { opacity: 1; }
    }

    body::before, body::after {
        content: '';
        position: fixed; /* Cover the whole viewport */
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: transparent; /* No actual background color */
        z-index: -1; /* Behind all other body content */
        animation: twinkle 10s infinite linear; /* Slow continuous twinkle for the layer */
    }

    /* Layer 1: Smaller, denser stars */
    body::before {
        box-shadow:
            /* Generate about 50-70 small stars */
            /* Format: x y size color (using 0px for blur and spread for size) */
            /* Example: 5vw 10vh 0px 0px #FFF, ... */
            /* I will create a list of these */
            10vw 20vh 0px 0px rgba(255,255,255,0.8), 80vw 30vh 0px 0px rgba(255,255,255,0.7),
            30vw 45vh 0px 0px rgba(255,255,255,0.9), 70vw 60vh 0px 0px rgba(255,255,255,0.6),
            50vw 5vh 0px 0px rgba(255,255,255,0.8), 90vw 15vh 0px 0px rgba(255,255,255,0.7),
            25vw 70vh 0px 0px rgba(255,255,255,0.9), 65vw 85vh 0px 0px rgba(255,255,255,0.6),
            5vw 90vh 0px 0px rgba(255,255,255,0.8), 95vw 50vh 0px 0px rgba(255,255,255,0.7),
            40vw 10vh 0px 0px rgba(200,200,255,0.7), 60vw 25vh 0px 0px rgba(200,200,255,0.6),
            15vw 35vh 0px 0px rgba(200,200,255,0.8), 85vw 55vh 0px 0px rgba(200,200,255,0.7),
            /* Add more for density */
            5vw 50vh 0px 0px #FFF, 15vw 60vh 0px 0px #FFF, 25vw 5vh 0px 0px #FFF, 35vw 15vh 0px 0px #FFF,
            45vw 25vh 0px 0px #FFF, 55vw 35vh 0px 0px #FFF, 65vw 45vh 0px 0px #FFF, 75vw 55vh 0px 0px #FFF,
            85vw 65vh 0px 0px #FFF, 95vw 75vh 0px 0px #FFF, 5vw 85vh 0px 0px #FFF, 15vw 95vh 0px 0px #FFF,
            22vw 33vh 0px 0px #FFF, 33vw 44vh 0px 0px #FFF, 44vw 55vh 0px 0px #FFF, 55vw 66vh 0px 0px #FFF,
            66vw 77vh 0px 0px #FFF, 77vw 88vh 0px 0px #FFF, 88vw 99vh 0px 0px #FFF, 99vw 11vh 0px 0px #FFF,
            11vw 22vh 0px 0px #FFF, 20vw 10vh 0px 0px #FFF, 30vw 20vh 0px 0px #FFF, 40vw 30vh 0px 0px #FFF,
            50vw 40vh 0px 0px #FFF, 60vw 50vh 0px 0px #FFF, 70vw 60vh 0px 0px #FFF, 80vw 70vh 0px 0px #FFF,
            90vw 80vh 0px 0px #FFF, 98vw 90vh 0px 0px #FFF, 2vw 5vh 0px 0px #FFF, 12vw 15vh 0px 0px #FFF,
            22vw 25vh 0px 0px #FFF, 32vw 35vh 0px 0px #FFF, 42vw 45vh 0px 0px #FFF, 52vw 55vh 0px 0px #FFF,
            62vw 65vh 0px 0px #FFF, 72vw 75vh 0px 0px #FFF, 82vw 85vh 0px 0px #FFF, 92vw 95vh 0px 0px #FFF;
        animation-duration: 200s; /* Slower twinkle for this layer */
        animation-delay: -100s; /* Start animation partway through */
    }

    /* Layer 2: Slightly larger, sparser stars, different animation */
    body::after {
        box-shadow:
            /* Generate about 30-40 slightly larger/brighter stars */
            /* Format: x y blur spread color (spread can be 1px for slightly larger) */
            /* Example: 15vw 25vh 1px 1px #FFC, ... */
            /* I will create a list of these */
            5vw 15vh 0px 1px rgba(255,255,224,0.9), 95vw 25vh 0px 1px rgba(255,255,224,0.8),
            20vw 35vh 0px 1px rgba(255,255,224,1), 80vw 45vh 0px 1px rgba(255,255,224,0.7),
            30vw 55vh 0px 1px rgba(255,255,224,0.9), 70vw 65vh 0px 1px rgba(255,255,224,0.8),
            40vw 75vh 0px 1px rgba(255,255,224,1), 60vw 85vh 0px 1px rgba(255,255,224,0.7),
            10vw 95vh 0px 1px rgba(255,255,200,0.9), 90vw 5vh 0px 1px rgba(255,255,200,0.8),
            /* Add more for density */
            18vw 8vh 0px 1px #FFF, 28vw 18vh 0px 1px #FFF, 38vw 28vh 0px 1px #FFF, 48vw 38vh 0px 1px #FFF,
            58vw 48vh 0px 1px #FFF, 68vw 58vh 0px 1px #FFF, 78vw 68vh 0px 1px #FFF, 88vw 78vh 0px 1px #FFF,
            8vw 88vh 0px 1px #FFF, 18vw 98vh 0px 1px #FFF, 25vw 25vh 0px 1px #FFF, 35vw 35vh 0px 1px #FFF,
            45vw 45vh 0px 1px #FFF, 55vw 55vh 0px 1px #FFF, 65vw 65vh 0px 1px #FFF, 75vw 75vh 0px 1px #FFF,
            85vw 85vh 0px 1px #FFF, 95vw 95vh 0px 1px #FFF, 5vw 10vh 0px 1px #FFF, 15vw 20vh 0px 1px #FFF;
        animation-duration: 150s; /* Different twinkle speed */
        animation-delay: -50s;
    }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <span class="dot">.</span><span class="rest">rest</span><span class="radio">radio</span>
        </div>
        
        <div class="loading" id="loading">Подключение...</div>
        
        <div class="now-playing" id="nowPlaying"></div>
        <div class="status" id="status"></div>

        <button class="play-button" id="playButton">
            <svg class="play-icon" viewBox="0 0 24 24">
                <path d="M7 4v16l13-8z"/>
            </svg>
            <svg class="stop-icon" viewBox="0 0 24 24">
                <rect x="6" y="6" width="12" height="12" rx="2"/>
            </svg>
        </button>
    </div>

    <audio id="audioPlayer" preload="none"></audio>

    <script>
        class RestRadioPlayer {
            constructor() {
                this.audio = document.getElementById('audioPlayer');
                this.playButton = document.getElementById('playButton');
                this.nowPlaying = document.getElementById('nowPlaying');
                this.status = document.getElementById('status');
                this.loading = document.getElementById('loading');
                this.playIcon = document.querySelector('.play-icon');
                this.stopIcon = document.querySelector('.stop-icon');
                
                this.isPlaying = false;
                this.streamUrl = 'https://stream.restradio.online/live';
                this.statusUrl = 'https://stream.restradio.online/status-json.xsl';
                
                this.init();
            }

            init() {
                this.playButton.addEventListener('click', () => this.togglePlay());
                this.audio.addEventListener('loadstart', () => this.showLoading());
                this.audio.addEventListener('canplay', () => this.hideLoading());
                this.audio.addEventListener('play', () => this.onPlay());
                this.audio.addEventListener('pause', () => this.onPause());
                this.audio.addEventListener('error', () => this.onError());
                
                // Обновляем информацию о треке каждые 10 секунд когда играет
                setInterval(() => {
                    if (this.isPlaying) {
                        this.updateTrackInfo();
                    }
                }, 10000);
            }

            async togglePlay() {
                if (this.isPlaying) {
                    this.stop();
                } else {
                    await this.play();
                }
            }

            async play() {
                try {
                    this.showLoading();
                    this.audio.src = this.streamUrl;
                    await this.audio.play();
                    this.updateTrackInfo();
                } catch (error) {
                    console.error('Ошибка воспроизведения:', error);
                    this.onError();
                }
            }

            stop() {
                this.audio.pause();
                this.audio.src = '';
                this.isPlaying = false;
                this.updateUI();
            }

            showLoading() {
                this.loading.classList.add('show');
            }

            hideLoading() {
                this.loading.classList.remove('show');
            }

            onPlay() {
                this.isPlaying = true;
                this.updateUI();
            }

            onPause() {
                this.isPlaying = false;
                this.updateUI();
            }

            onError() {
                this.isPlaying = false;
                this.hideLoading();
                this.nowPlaying.textContent = 'Ошибка подключения к радио';
                this.nowPlaying.classList.add('show');
                this.status.textContent = 'Проверьте подключение к интернету';
                this.status.classList.add('show');
                this.updateUI();
            }

            updateUI() {
                if (this.isPlaying) {
                    this.playIcon.style.display = 'none';
                    this.stopIcon.style.display = 'block';
                } else {
                    this.playIcon.style.display = 'block';
                    this.stopIcon.style.display = 'none';
                    this.nowPlaying.classList.remove('show');
                    this.status.classList.remove('show');
                    this.status.textContent = '';
                }
            }

            async updateTrackInfo() {
                try {
                    // Используем публичный CORS-прокси для обхода ограничений
                    const corsProxyUrl = 'https://corsproxy.io/?url=';
                    const response = await fetch(this.statusUrl);
                    const data = await response.json();
                    
                    if (data.icestats && data.icestats.source) {
                        const title = data.icestats.source.title || 'restradio.ru';
                        const listeners = data.icestats.source.listeners || 0;
                        
                        this.nowPlaying.textContent = title;
                        this.nowPlaying.classList.add('show');
                        this.status.textContent = `Слушателей: ${listeners}`;
                        this.status.classList.add('show');
                    }
                } catch (error) {
                    console.error('Ошибка получения информации о треке:', error);
                    this.showDefaultInfo();
                }
            }
            
            showDefaultInfo() {
                // Показываем базовую информацию если API недоступен
                this.nowPlaying.textContent = 'restradio.ru';
                this.nowPlaying.classList.add('show');
            }
        }

        // Инициализируем плеер когда страница загружена
        document.addEventListener('DOMContentLoaded', () => {
            new RestRadioPlayer();
        });
    </script>
</body>
</html>
